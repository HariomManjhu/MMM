<%- include('partials/header') %>

<div class="container py-5">
  <h1 class="text-center mb-5">Meal History</h1>

  <div class="card p-4 mb-4">
    <form class="row g-3 align-items-end">
      <div class="col-md-4">
        <label for="meal_type" class="form-label">Filter by Meal</label>
        <select name="meal_type" id="meal_type" class="form-select">
          <option value="">All</option>
          <option value="breakfast" <%= filters.meal_type === 'breakfast' ? 'selected' : '' %>>Breakfast</option>
          <option value="lunch" <%= filters.meal_type === 'lunch' ? 'selected' : '' %>>Lunch</option>
          <option value="dinner" <%= filters.meal_type === 'dinner' ? 'selected' : '' %>>Dinner</option>
        </select>
      </div>
      <div class="col-md-4">
        <label for="date" class="form-label">Filter by Date</label>
        <input type="date" name="date" id="date" class="form-control" value="<%= filters.date || '' %>">
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn w-100">Apply Filters</button>
      </div>
    </form>
  </div>

  <div class="card p-4">
    <% if (mealHistory.length > 0) { %>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Date</th>
              <th>Meal</th>
              <th>Food Item</th>
              <th>Qty</th>
              <th>Calories</th>
              <th>Protein</th>
              <th>Carbs</th>
              <th>Fat</th>
            </tr>
          </thead>
          <tbody>
            <% mealHistory.forEach(meal => { %>
              <tr>
                <td><%= new Date(meal.date).toLocaleDateString() %></td>
                <td><%= meal.meal_type %></td>
                <td><%= meal.food_item %></td>
                <td><%= meal.quantity %></td>
                <td><%= meal.calories %></td>
                <td><%= meal.protein %>g</td>
                <td><%= meal.carbs %>g</td>
                <td><%= meal.fat %>g</td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } else { %>
      <p class="text-center text-muted">You haven't logged any meals yet.</p>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %> 